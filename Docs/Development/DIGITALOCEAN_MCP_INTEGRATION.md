# DigitalOcean MCP Integration Setup\n\n## Project: Vibe Dev Squad Official\n**Last Updated:** December 24, 2024\n\n---\n\n## Overview\n\nThis document outlines the implementation of **DigitalOcean Model Context Protocol (MCP) integration** for automated deployment and server management of our Next.js application.\n\n### What is MCP?\nModel Context Protocol (MCP) is a standardized, open protocol that enables AI agents to interact with external services like cloud infrastructure, databases, and APIs in a unified, secure, and scalable way. It eliminates the need for custom connectors between each AI tool and service.\n\n---\n\n## Architecture Overview\n\n```\n┌─────────────────┐    ┌──────────────┐    ┌─────────────────┐\n│   AI Agent      │◄──►│   MCP Hub    │◄──►│  DigitalOcean   │\n│   (Claude/GPT)  │    │   (Protocol) │    │   API & Infra   │\n└─────────────────┘    └──────────────┘    └─────────────────┘\n         │                      │                      │\n         ▼                      ▼                      ▼\n┌─────────────────┐    ┌──────────────┐    ┌─────────────────┐\n│   Next.js App   │    │  Monitoring  │    │   Droplets &    │\n│   Repository    │    │  & Alerts    │    │   Services      │\n└─────────────────┘    └──────────────┘    └─────────────────┘\n```\n\n---\n\n## Infrastructure Requirements\n\n### DigitalOcean Resources\n- **App Platform** - For Next.js application hosting\n- **Droplets** - For custom server configurations (if needed)\n- **Managed Database** - PostgreSQL for Supabase integration\n- **Spaces** - Object storage for static assets\n- **Load Balancer** - For high availability\n- **Monitoring & Alerting** - Performance tracking\n\n### MCP Components\n- **MCP Server** - Handles protocol communication\n- **Action Definitions** - Deploy, scale, monitor, rollback\n- **Context Management** - State tracking and decision making\n- **Security Layer** - API token management and access control\n\n---\n\n## Setup Instructions\n\n### Phase 1: DigitalOcean Account Setup\n\n1. **Create DigitalOcean Account**\n   ```bash\n   # Visit: https://cloud.digitalocean.com/\n   # Create account and verify email\n   ```\n\n2. **Generate API Token**\n   ```bash\n   # Navigate to API → Tokens/Keys\n   # Generate new Personal Access Token\n   # Scope: Read & Write\n   # Expiration: No expiration (for production use shorter periods)\n   ```\n\n3. **Configure Environment Variables**\n   ```bash\n   # Add to .env.local\n   DIGITALOCEAN_API_TOKEN=your_api_token_here\n   DIGITALOCEAN_REGION=nyc3  # or preferred region\n   DIGITALOCEAN_SIZE=s-1vcpu-1gb  # droplet size\n   ```\n\n### Phase 2: MCP Integration Setup\n\n1. **Install MCP Dependencies**\n   ```bash\n   npm install @digitalocean/api @modelcontextprotocol/client\n   ```\n\n2. **Create MCP Configuration**\n   ```typescript\n   // src/lib/mcp-digitalocean.ts\n   import { DigitalOcean } from '@digitalocean/api'\n   import { MCPClient } from '@modelcontextprotocol/client'\n   \n   export const doClient = new DigitalOcean({\n     token: process.env.DIGITALOCEAN_API_TOKEN!\n   })\n   \n   export const mcpActions = {\n     deployApp: async (config: DeployConfig) => {\n       // Implementation for app deployment\n     },\n     scaleApp: async (instances: number) => {\n       // Implementation for scaling\n     },\n     monitorApp: async () => {\n       // Implementation for monitoring\n     },\n     rollbackApp: async (version: string) => {\n       // Implementation for rollback\n     }\n   }\n   ```\n\n### Phase 3: App Platform Configuration\n\n1. **Create App Specification**\n   ```yaml\n   # .do/app.yaml\n   name: vibedev-squad-official\n   services:\n   - name: web\n     source_dir: /\n     github:\n       repo: vibedev-squad-official/vibedev-squad-official\n       branch: main\n     run_command: npm start\n     environment_slug: node-js\n     instance_count: 1\n     instance_size_slug: basic-xxs\n     routes:\n     - path: /\n     health_check:\n       http_path: /api/health\n   databases:\n   - name: db\n     engine: PG\n     num_nodes: 1\n     size: db-s-1vcpu-1gb\n   ```\n\n2. **Deploy to App Platform**\n   ```bash\n   # Install doctl CLI\n   brew install doctl  # macOS\n   # or\n   snap install doctl  # Linux\n   \n   # Authenticate\n   doctl auth init --access-token $DIGITALOCEAN_API_TOKEN\n   \n   # Create app\n   doctl apps create --spec .do/app.yaml\n   ```\n\n### Phase 4: MCP Action Implementation\n\n1. **Deployment Actions**\n   ```typescript\n   // src/lib/mcp-actions/deploy.ts\n   export async function deployToProduction(commitSha: string) {\n     const mcpResponse = await mcpClient.request({\n       action: 'deploy',\n       parameters: {\n         platform: 'digitalocean-app-platform',\n         repository: 'vibedev-squad-official/vibedev-squad-official',\n         branch: 'main',\n         commitSha,\n         environment: 'production'\n       }\n     })\n     \n     return mcpResponse\n   }\n   ```\n\n2. **Monitoring Actions**\n   ```typescript\n   // src/lib/mcp-actions/monitor.ts\n   export async function getAppHealth() {\n     const mcpResponse = await mcpClient.request({\n       action: 'monitor',\n       parameters: {\n         service: 'vibedev-squad-official',\n         metrics: ['cpu', 'memory', 'requests', 'errors'],\n         timeframe: '1h'\n       }\n     })\n     \n     return mcpResponse\n   }\n   ```\n\n3. **Scaling Actions**\n   ```typescript\n   // src/lib/mcp-actions/scale.ts\n   export async function scaleApplication(instances: number) {\n     const mcpResponse = await mcpClient.request({\n       action: 'scale',\n       parameters: {\n         service: 'vibedev-squad-official',\n         instanceCount: instances,\n         instanceSize: 'basic-xs'\n       }\n     })\n     \n     return mcpResponse\n   }\n   ```\n\n---\n\n## Automation Workflows\n\n### CI/CD Integration\n\n1. **GitHub Actions Workflow**\n   ```yaml\n   # .github/workflows/deploy.yml\n   name: Deploy to DigitalOcean\n   \n   on:\n     push:\n       branches: [main]\n   \n   jobs:\n     deploy:\n       runs-on: ubuntu-latest\n       steps:\n         - uses: actions/checkout@v4\n         - name: Deploy via MCP\n           run: |\n             node scripts/mcp-deploy.js\n           env:\n             DIGITALOCEAN_API_TOKEN: ${{ secrets.DIGITALOCEAN_API_TOKEN }}\n             MCP_SERVER_URL: ${{ secrets.MCP_SERVER_URL }}\n   ```\n\n2. **Deployment Script**\n   ```javascript\n   // scripts/mcp-deploy.js\n   const { deployToProduction } = require('../src/lib/mcp-actions/deploy')\n   \n   async function main() {\n     const commitSha = process.env.GITHUB_SHA\n     const result = await deployToProduction(commitSha)\n     \n     console.log('Deployment result:', result)\n   }\n   \n   main().catch(console.error)\n   ```\n\n### Monitoring Integration\n\n1. **Health Check Endpoint**\n   ```typescript\n   // src/app/api/health/route.ts\n   export async function GET() {\n     const health = {\n       status: 'healthy',\n       timestamp: new Date().toISOString(),\n       version: process.env.npm_package_version,\n       environment: process.env.NODE_ENV\n     }\n     \n     return Response.json(health)\n   }\n   ```\n\n2. **Alert Configuration**\n   ```typescript\n   // src/lib/mcp-actions/alerts.ts\n   export async function setupAlerts() {\n     await mcpClient.request({\n       action: 'configure-alerts',\n       parameters: {\n         service: 'vibedev-squad-official',\n         alerts: [\n           {\n             metric: 'cpu_usage',\n             threshold: 80,\n             operator: 'greater_than',\n             action: 'scale_up'\n           },\n           {\n             metric: 'error_rate',\n             threshold: 5,\n             operator: 'greater_than',\n             action: 'notify_team'\n           }\n         ]\n       }\n     })\n   }\n   ```\n\n---\n\n## Security Best Practices\n\n### API Token Management\n- Use **environment variables** for tokens\n- **Rotate tokens** regularly (90 days max)\n- **Limit scope** to minimum required permissions\n- **Audit access** logs monthly\n\n### Network Security\n- Enable **firewalls** on all droplets\n- Use **VPC** for internal communication\n- Implement **SSL/TLS** everywhere\n- **Monitor** for suspicious activity\n\n### Access Control\n- **Team-based** access to DigitalOcean console\n- **Role-based** permissions for MCP actions\n- **Multi-factor authentication** required\n- **Audit trails** for all deployments\n\n---\n\n## Cost Optimization\n\n### Resource Sizing\n- **App Platform**: Start with `basic-xxs` ($5/month)\n- **Database**: Use managed PostgreSQL `db-s-1vcpu-1gb` ($15/month)\n- **Monitoring**: Built-in monitoring is free\n- **Total Estimated**: ~$25-50/month for production\n\n### Auto-scaling Rules\n```typescript\n// Cost-aware scaling configuration\nexport const scalingConfig = {\n  minInstances: 1,\n  maxInstances: 3,\n  scaleUpThreshold: {\n    cpu: 70,\n    memory: 80,\n    responseTime: 500\n  },\n  scaleDownThreshold: {\n    cpu: 30,\n    memory: 40,\n    responseTime: 200\n  },\n  cooldownPeriod: 300 // 5 minutes\n}\n```\n\n---\n\n## Troubleshooting\n\n### Common Issues\n\n1. **Deployment Failures**\n   ```bash\n   # Check build logs\n   doctl apps logs show <app-id>\n   \n   # Check MCP connection\n   node scripts/test-mcp-connection.js\n   ```\n\n2. **Performance Issues**\n   ```bash\n   # Monitor metrics\n   doctl monitoring metrics show --resource-type=app --resource-id=<app-id>\n   ```\n\n3. **Connection Issues**\n   ```bash\n   # Test API connectivity\n   curl -H \"Authorization: Bearer $DIGITALOCEAN_API_TOKEN\" \\\n        \"https://api.digitalocean.com/v2/account\"\n   ```\n\n### Support Contacts\n- **DigitalOcean Support**: [Support Portal](https://www.digitalocean.com/support/)\n- **MCP Documentation**: [MCP Protocol Docs](https://github.com/modelcontextprotocol/specification)\n- **Internal Team**: Create issue with `infrastructure` label\n\n---\n\n## Next Steps\n\n### Phase 0: Foundation ✅\n- [x] Documentation created\n- [ ] DigitalOcean account setup\n- [ ] API tokens configured\n- [ ] Environment variables set\n\n### Phase 1: Basic Setup (Week 1)\n- [ ] Install MCP dependencies\n- [ ] Create basic deployment actions\n- [ ] Set up App Platform\n- [ ] Configure health checks\n\n### Phase 2: Automation (Week 2)\n- [ ] GitHub Actions integration\n- [ ] Automated deployments\n- [ ] Monitoring setup\n- [ ] Alert configuration\n\n### Phase 3: Optimization (Week 3)\n- [ ] Auto-scaling implementation\n- [ ] Performance monitoring\n- [ ] Cost optimization\n- [ ] Security hardening\n\n---\n\n**Status**: 📋 **DOCUMENTED - READY FOR IMPLEMENTATION** 